document.addEventListener("DOMContentLoaded",function(){const y=new Date().getFullYear(),yearEl=document.getElementById("year");yearEl&&(yearEl.textContent=y);const toggle=document.querySelector('.nav-toggle'),nav=document.querySelector('.main-nav');if(toggle&&nav){toggle.addEventListener('click',function(){nav.style.display==='block'?nav.style.display='':nav.style.display='block'});nav.querySelectorAll('a').forEach(a=>{a.addEventListener('click',()=>{window.innerWidth<768&&(nav.style.display='')})});window.addEventListener('resize',()=>{window.innerWidth>=768&&(nav.style.display='')})}const header=document.querySelector('.site-header');if(header){let lastScroll=window.scrollY||0,delta=10;window.addEventListener('scroll',()=>{const current=window.scrollY||0;if(Math.abs(current-lastScroll)<=delta)return;current>lastScroll&&current>80?header.classList.add('hidden'):header.classList.remove('hidden');lastScroll=current},{passive:!0})}const lightbox=document.getElementById('lightbox'),lbImage=lightbox&&lightbox.querySelector('.lb-image'),lbCaption=lightbox&&lightbox.querySelector('.lb-caption'),lbClose=lightbox&&lightbox.querySelector('.lb-close');let lastFocused=null;document.querySelectorAll('.service-card, .reasons li, .gallery-grid figure, .about p, .contact-card').forEach(el=>el.classList.add('reveal'));const observer=new IntersectionObserver((entries=>{entries.forEach(entry=>{entry.isIntersecting&&entry.target.classList.add('is-visible')})}),{threshold:.12});document.querySelectorAll('.reveal').forEach(el=>observer.observe(el));document.querySelectorAll('.gallery-grid img').forEach(img=>{img.addEventListener('click',e=>{if(!lightbox)return;const src=img.dataset.full||img.src;lbImage.src=src;lbImage.alt=img.alt||"";lbCaption.textContent=img.nextElementSibling?img.nextElementSibling.textContent:'';lightbox.setAttribute('aria-hidden','false');document.body.style.overflow='hidden';lastFocused=document.activeElement;lbClose.focus()})});if(lbClose){lbClose.addEventListener('click',()=>{lightbox.setAttribute('aria-hidden','true');lbImage.src='';document.body.style.overflow='';if(lastFocused)lastFocused.focus()})}if(lightbox){lightbox.addEventListener('click',e=>{e.target===lightbox&&(lightbox.setAttribute('aria-hidden','true'),lbImage.src='',document.body.style.overflow='',lastFocused&&lastFocused.focus())});window.addEventListener('keydown',e=>{'Escape'===e.key&&lightbox.getAttribute('aria-hidden')==='false'&&(lightbox.setAttribute('aria-hidden','true'),lbImage.src='',document.body.style.overflow='',lastFocused&&lastFocused.focus());if('Tab'===e.key&&lightbox.getAttribute('aria-hidden')==='false'){const focusable=Array.from(lightbox.querySelectorAll('button, a, [href], input, textarea, [tabindex]:not([tabindex="-1"])')).filter(Boolean);if(0===focusable.length)return;const first=focusable[0],last=focusable[focusable.length-1];if(e.shiftKey&&document.activeElement===first){e.preventDefault();last.focus()}else if(!e.shiftKey&&document.activeElement===last){e.preventDefault();first.focus()}}})}});